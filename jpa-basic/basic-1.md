## ORM과 SQL Mapper 차이

#### ORM (Object Relational Mapping)
- 객체 관계 매핑, 객체와 RDB를 매핑시켜 DB의 테이블을 객체지향적으로 사용하기 위한 기술<br/>
- 애플리케이션 내 객체와 RDB의 테이블이 매핑되어 RDB를 객체처럼 사용할 수 있다
- ORM을 사용하면 SQL문을 작성할 필요가 없다.
- **ORM을 사용하기 위해서는 설계가 잘 되어 있어야한다.**

#### SQL Mapper
- 객체와 SQL문을 매핑하여 데이터를 객체화하는 기술
- SQL문의 질의 결과와 객체를 매핑하는 기술

<br/>

## JPA란? 
- 자바 진영에서의 ORM 표준, JPA는 자바 ORM 기술에 대한 API 표준 명세
- 인터페이스들로 이루어져 있으며, JPA를 사용하기 위해서 JPA의 구현체가 필요
    - Hibernate, EclipseLink, DataNucleus 등이 있다    

### 가장 중점적인 요소 2가지
1. 객체와 관계형 DB 매핑 (Object Relational Mapping)
2. 영속성 컨텍스트


### Entity란
JPA에서는 관계형 DB의 Table과 매핑되는 클래스를 말한다.<br/> 
예로 들어, 보통 MyBatis와 같은 SQL Mapper들은 SQL 결과를 매핑하기 위해 VO 클래스를 정의한다.<br/>
DB에 Board라는 Table이 있다고 가정하자 MyBatis를 사용했다면 BoardVO라는 클래스를 만들었다.<br/> 
JPA에서는 Board 테이블과 관계를 형성하기 위해서 엔티티 클래스를 정의해야하고 Board 라는 클래스를 만들고<br/> 
이를 Board 엔티티라고 명칭하여 JPA가 엔티티 정보를 읽고 관리해주는 개념이라고 보면 된다.  

<br/>

# 영속성 관리

**엔티티 매니저 팩토리(Entity Manager Factory)**<br/>
- 엔티티 매니저 팩토리는 애티티 매니저를 만드는 공장
- 만드는 비용이 매우 크기 때문에 애플리케이션 실행 시 한번만 만들고 전체가 공유해서 사용
- 즉, 전체가 공유하기 때문에 동시성에 대해서 안전해 Thread-Safe 하다

**엔티티 매니저(Entity Manager)**
- 엔티티(Entity)를 저장,수정,삭제,조회와 같은 엔티티와 연관된 모든 일들을 처리한다.
- 엔티티 매니저를 생성하는 비용은 매우 적다.
- 엔티티 매니저는 여러 쓰레드에서 접근하게되면 동시성 문제가 발생하여 절대로 쓰레드 간에 공유해선 안된다.

**영속성 컨텍스트**
- 엔티티를 영구 저장하는 환경
- 엔티티 매니저는 영속성 컨텍스트에 엔티티를 저장하고 관리한다.
- 엔티티는 반드시 식별자가 있어야한다. (영속성 컨텍스트는 엔티티 데이터를 식별자로 구분하기 때문)

**영속성 컨텍스트 특징**
1. 영속성 컨텍스트는 엔티티를 식별 Key 값으로 구분하므로 반드시 Key 값이 필요
2. 영속성 컨텍스트에 저장된 엔티티들은 트랜잭션이 flash 되는 순간에 반영됨
3. 영속성 컨텍스트를 통해 얻는 이점
    - 1차 캐싱
    - 동일성 보장 
    - 쓰기 지연
    - Dirty Checking
    - Lazy Loading
    
 

**엔티티 라이프 사이클**
1. 비영속 : 영속성 컨텍스트와 전혀 관계가 없는 상태
2. 영속 : 영속성 컨텍스트에 저장된 상태
3. 준영속 : 영속성 컨텍스트에 저장되었다가 분리된 상태
4. 삭제 : 영속성 컨텍스트에서 삭제된 상태


